<section class="home">

  <!-- Hero compacto -->
  <header class="hero">
    <div class="hero-text">
      <h1>Bienvenido a <span>DebtGo</span> ğŸ‘‹</h1>
      <p>
        Tu asistente financiero digital: organiza tus deudas, gestiona pagos,
        conecta con consultores y mejora tu educaciÃ³n financiera.
      </p>
      <div class="hero-actions">
        <button class="btn primary" routerLink="/payment-history">ğŸš€ Ver pagos</button>
        <button class="btn ghost" routerLink="/cases">â• AÃ±adir deuda</button>
      </div>
    </div>
  </header>

  <!-- Estado de carga / error -->
  <div *ngIf="loading" class="state info">â³ Cargando tu panel...</div>
  <div *ngIf="!loading && errorMsg" class="state error">{{ errorMsg }}</div>

  <!-- Panel principal -->
  <ng-container *ngIf="!loading && !errorMsg">

    <!-- KPIs -->
    <section class="summary-grid">
      <article class="card kpi debt">
        <span class="icon">ğŸ’³</span>
        <h3>Deudas activas</h3>
        <p class="number">{{ summary?.debtsActive || 0 }}</p>
        <p class="sub">Total pendiente: <b>S/ {{ summary?.totalPending || 0 | number }}</b></p>
      </article>

      <article class="card kpi payments">
        <span class="icon">ğŸ“…</span>
        <h3>PrÃ³ximos pagos</h3>
        <p class="number">{{ summary?.upcomingPayments || 0 }}</p>
        <p class="sub">Esta semana / mes</p>
      </article>

      <article class="card kpi alerts">
        <span class="icon">âš ï¸</span>
        <h3>Alertas</h3>
        <p class="number">{{ summary?.alerts || 0 }}</p>
        <p class="sub">Vencimientos y avisos</p>
      </article>

      <article class="card kpi cta">
        <h3>Accesos rÃ¡pidos</h3>
        <div class="quick-links">
          <a routerLink="/cases" class="quick-item">â• <span>Nueva deuda</span></a>
          <a routerLink="/consultants" class="quick-item">ğŸ‘¨â€ğŸ’¼ <span>Consultores</span></a>
          <a routerLink="/education" class="quick-item">ğŸ“˜ <span>EducaciÃ³n</span></a>
        </div>
      </article>
    </section>

    <!-- Grid de contenido -->
    <section class="main-grid">
      <div class="col">
        <!-- Notificaciones -->
        <article class="card">
          <header>
            <h3>ğŸ”” Notificaciones</h3>
            <a routerLink="/payment-history">Ver todo</a>
          </header>
          <ul class="list">
            <li *ngFor="let n of notifications; trackBy: trackById" class="list-item">
              <span class="badge"
                [ngClass]="{'warn': n.type==='ALERT', 'info': n.type==='INFO', 'pay': n.type==='PAYMENT'}">
                {{ n.type }}
              </span>
              <div>
                <p>{{ n.message }}</p>
                <small>{{ n.date | date:'dd/MM/yyyy, HH:mm' }}</small>
              </div>
            </li>
            <li *ngIf="!notifications?.length" class="empty">ğŸ‰ No tienes notificaciones</li>
          </ul>
        </article>

        <!-- Movimientos -->
        <article class="card">
          <header>
            <h3>ğŸ“‘ Ãšltimos movimientos</h3>
            <a routerLink="/payment-history">Historial</a>
          </header>
          <div *ngFor="let m of movements; trackBy: trackByIndex" class="movement">
            <div>{{ m.date | date:'dd/MM/yyyy' }}</div>
            <div>{{ m.concept }}</div>
            <div [class.neg]="m.amount < 0">
              {{ m.amount | currency:'PEN':'symbol':'1.0-2' }}
            </div>
            <span class="chip" [ngClass]="m.status.toLowerCase()">
              {{ m.status }}
            </span>
          </div>
          <div *ngIf="!movements?.length" class="empty">AÃºn no hay movimientos.</div>
        </article>
      </div>

      <!-- EducaciÃ³n financiera + Consejo del dÃ­a -->
      <div class="col">
        <article class="card">
          <header>
            <h3>ğŸ“˜ EducaciÃ³n financiera</h3>
            <a routerLink="/education">Ver mÃ¡s</a>
          </header>
          <div class="edu-grid">
            <a *ngFor="let e of highlights; trackBy: trackById"
               class="edu-item" [href]="e.link" target="_blank">
              <span class="tag">{{ e.category }}</span>
              <h4>{{ e.title }}</h4>
              <small>{{ e.level }}</small>
            </a>
          </div>
        </article>

        <!-- Consejo del dÃ­a -->
        <article class="card tip-card">
          <h3>ğŸ’¡ Consejo del dÃ­a</h3>
          <p>â€œAhorra al menos el 10% de tus ingresos cada mes para construir tu fondo de emergencia.â€</p>
        </article>
      </div>
    </section>
  </ng-container>
</section>